Вопросов не имею.

Расчет витрин реализовал раздельно. Загрузку и общие вычисления реализовал отдельным модулем. 

Расчет регистраций по первому сообщению пользователя сделал.

Остальные замечания тоже постарался реализовать. В коде откомментированы места исправлений.

Временные зоны уже сил нет побеждать, но вроде замечание не критическое.